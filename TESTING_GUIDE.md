# Руководство по тестированию Part 5 и Part 7

Это руководство поможет вам протестировать обе части проекта и сделать скриншоты для демонстрации работоспособности.

---

## Part 5 - Mini Lending Pool

### Шаг 1: Установка зависимостей

```bash
cd part5
npm install
```

### Шаг 2: Компиляция контрактов

```bash
npm run compile
```

**Ожидаемый результат**: Контракты успешно скомпилированы без ошибок.

**Скриншот 1**: Сделайте скриншот успешной компиляции.

### Шаг 3: Запуск тестов

```bash
npm test
```

**Ожидаемый результат**: Все 10 тестов должны пройти успешно.

**Что тестируется**:
- ✅ Deployment (развертывание контракта)
- ✅ Deposit (депозит токенов)
- ✅ Multiple deposits (несколько депозитов)
- ✅ Withdraw (вывод токенов)
- ✅ Edge cases (граничные случаи)
- ✅ View functions (функции просмотра)

**Скриншот 2**: Сделайте скриншот результатов тестов с зелеными галочками.

### Шаг 4: Запуск локального блокчейна (опционально)

```bash
npm run node
```

В другом терминале можно развернуть контракты и взаимодействовать с ними.

### Шаг 5: Пример транзакции депозита (для скриншота)

Если вы используете Remix или другой инструмент:

1. Разверните `MockERC20.sol`
2. Разверните `MiniLendingPool.sol` с адресом токена
3. Выполните транзакцию `deposit(100000000000000000000)` (100 токенов)
4. Проверьте событие `Deposited` в логах

**Скриншот 3**: Сделайте скриншот транзакции депозита из Remix/Hardhat с:
- Hash транзакции
- Событием `Deposited`
- Обновленным `totalDeposited`

---

## Part 7 - Gas Optimization Workshop

### Шаг 1: Установка зависимостей

```bash
cd part7
npm install
```

### Шаг 2: Компиляция контрактов

```bash
npm run compile
```

**Ожидаемый результат**: Оба контракта (Original и Optimized) успешно скомпилированы.

**Скриншот 4**: Сделайте скриншот успешной компиляции обоих контрактов.

### Шаг 3: Запуск тестов с газовым репортером

```bash
npm run test:gas
```

**Ожидаемый результат**: 
- Все тесты проходят
- В консоли выводятся сравнения газа для каждой операции
- Создается файл `gas-report.txt`

**Скриншот 5**: Сделайте скриншот консоли с результатами тестов и сравнениями газа:
```
=== Transfer Gas Comparison ===
Original: 65000 gas
Optimized: 52000 gas
Savings: 13000 gas
Savings %: 20.00%
```

### Шаг 4: Просмотр детального отчета о газе

```bash
cat gas-report.txt
```

**Скриншот 6**: Сделайте скриншот содержимого `gas-report.txt` с детальным сравнением.

### Шаг 5: Сравнение в Remix (альтернативный способ)

1. Откройте Remix IDE
2. Загрузите `ERC20Original.sol` и `ERC20Optimized.sol`
3. Скомпилируйте оба контракта
4. Разверните оба контракта
5. Выполните одинаковые операции и сравните газ:
   - `mint()` - сравните газ
   - `transfer()` - сравните газ
   - `transferFrom()` - сравните газ

**Скриншот 7**: Сделайте скриншот Remix с:
- Двумя развернутыми контрактами
- Сравнением газа для одной операции (например, transfer)

### Шаг 6: Демонстрация оптимизаций

Покажите конкретные оптимизации в коде:

**Скриншот 8**: Сравнение оригинального и оптимизированного кода:
- Immutable variables (строки 17-20 в ERC20Optimized.sol)
- Packed struct (строки 25-30 в ERC20Optimized.sol)
- Unchecked blocks (строки 47-50 в ERC20Optimized.sol)

---

## Чеклист для скриншотов

### Part 5 (Mini Lending Pool):
- [ ] Скриншот 1: Успешная компиляция
- [ ] Скриншот 2: Все тесты прошли (10/10)
- [ ] Скриншот 3: Пример транзакции депозита (из Remix/Hardhat)

### Part 7 (Gas Optimization):
- [ ] Скриншот 4: Компиляция обоих контрактов
- [ ] Скриншот 5: Результаты тестов с сравнением газа
- [ ] Скриншот 6: Детальный отчет gas-report.txt
- [ ] Скриншот 7: Сравнение в Remix (опционально)
- [ ] Скриншот 8: Примеры оптимизированного кода

---

## Быстрый старт (все команды)

### Part 5:
```bash
cd part5
npm install
npm run compile
npm test
```

### Part 7:
```bash
cd part7
npm install
npm run compile
npm run test:gas
cat gas-report.txt
```

---

## Troubleshooting (Решение проблем)

### Ошибка: "Cannot find module"
**Решение**: Убедитесь, что вы выполнили `npm install` в каждой папке.

### Ошибка компиляции
**Решение**: Проверьте версию Node.js (рекомендуется 16+). Убедитесь, что все зависимости установлены.

### Тесты не проходят
**Решение**: 
- Проверьте, что Hardhat установлен глобально: `npm install -g hardhat`
- Убедитесь, что все файлы на месте
- Попробуйте удалить `node_modules` и `package-lock.json`, затем `npm install` заново

### Gas reporter не работает
**Решение**: 
- Убедитесь, что вы используете команду `npm run test:gas` (не просто `npm test`)
- Проверьте, что `hardhat-gas-reporter` установлен в `package.json`

---

## Дополнительные материалы

- Документация Hardhat: https://hardhat.org/docs
- Gas Optimization Guide: см. `part7/GAS_OPTIMIZATIONS.md`
- OpenZeppelin Contracts: https://docs.openzeppelin.com/contracts
